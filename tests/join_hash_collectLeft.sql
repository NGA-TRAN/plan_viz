explain SELECT f.f_dkey, f.timestamp, f.value, d.service
FROM   dimension_parquet_sorted d, fact_parquet_sorted f
WHERE  d.d_dkey = f.f_dkey
    AND d.env = 'prod'
    AND timestamp > TIMESTAMP '2023-01-01T08:00:00'
    AND timestamp <> TIMESTAMP '2023-01-01T12:00:00'
ORDER BY f.f_dkey, timestamp;
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: f.f_dkey ASC NULLS LAST, f.timestamp ASC NULLS LAST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |   Projection: f.f_dkey, f.timestamp, f.value, d.service                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |     Inner Join: d.d_dkey = f.f_dkey                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |       SubqueryAlias: d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |         Projection: dimension_parquet_sorted.d_dkey, dimension_parquet_sorted.service                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |           Filter: dimension_parquet_sorted.env = Utf8View("prod")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |             TableScan: dimension_parquet_sorted projection=[d_dkey, env, service], partial_filters=[dimension_parquet_sorted.env = Utf8View("prod")]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |       SubqueryAlias: f                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |         Filter: fact_parquet_sorted.timestamp > TimestampNanosecond(1672560000000000000, None) AND fact_parquet_sorted.timestamp != TimestampNanosecond(1672574400000000000, None)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |           TableScan: fact_parquet_sorted projection=[f_dkey, timestamp, value], partial_filters=[fact_parquet_sorted.timestamp > TimestampNanosecond(1672560000000000000, None), fact_parquet_sorted.timestamp != TimestampNanosecond(1672574400000000000, None)]                                                                                                                                                                                                                                                                                                                                                                                                                               |
| physical_plan | ProjectionExec: expr=[f_dkey@1 as f_dkey, timestamp@2 as timestamp, value@3 as value, service@0 as service]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |     HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(d_dkey@0, f_dkey@0)], projection=[service@1, f_dkey@2, timestamp@3, value@4]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |         FilterExec: env@1 = prod, projection=[d_dkey@0, service@2]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |           DataSourceExec: file_groups={1 group: [[d1.parquet]]}, projection=[d_dkey, env, service], output_ordering=[env@1 ASC NULLS LAST, service@2 ASC NULLS LAST], file_type=parquet, predicate=env@1 = prod, pruning_predicate=env_null_count@2 != row_count@3 AND env_min@0 <= prod AND prod <= env_max@1, required_guarantees=[env in (prod)]                                                                                                                                                                                                                                                                 |
|               |       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |         FilterExec: timestamp@1 > 1672560000000000000 AND timestamp@1 != 1672574400000000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |           DataSourceExec: file_groups={2 groups: [[f1.parquet], [f2.parquet]]}, projection=[f_dkey, timestamp, value], output_ordering=[f_dkey@0 ASC NULLS LAST, timestamp@1 ASC NULLS LAST], file_type=parquet, predicate=timestamp@1 > 1672560000000000000 AND timestamp@1 != 1672574400000000000 AND DynamicFilterPhysicalExpr [ true ], pruning_predicate=timestamp_null_count@1 != row_count@2 AND timestamp_max@0 > 1672560000000000000 AND timestamp_null_count@1 != row_count@2 AND (timestamp_min@3 != 1672574400000000000 OR 1672574400000000000 != timestamp_max@0), required_guarantees=[timestamp not in (1672574400000000000)] |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
